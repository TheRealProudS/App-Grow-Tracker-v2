{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://growtracker.app/schema/metadata/v1",
  "title": "GrowTracker Cannabis Leaf Image Metadata",
  "type": "object",
  "required": ["image_id", "source_path", "label", "capture_ts", "growth_stage"],
  "properties": {
    "image_id": {"type": "string", "pattern": "^[a-zA-Z0-9_-]{4,64}$", "description": "Unique ID referencing the raw image file (without extension)."},
    "source_path": {"type": "string", "description": "Relative path to original image inside raw/ tree."},
    "label": {"type": "string", "description": "Primary class label (must match labels_v1.csv)."},
    "secondary_labels": {"type": "array", "items": {"type": "string"}, "description": "Optional secondary / co-occurring conditions."},
    "severity": {"type": ["integer", "null"], "minimum": 1, "maximum": 3, "description": "Optional coarse severity scale 1=early 3=stark."},
    "growth_stage": {"type": "string", "enum": ["SEEDLING", "VEG_EARLY", "VEG_LATE", "FLOWER_EARLY", "FLOWER_MID", "FLOWER_LATE"], "description": "Plant phenological stage."},
    "leaf_age": {"type": ["string", "null"], "enum": ["NEW", "MATURE", "OLD"], "description": "Relative age of leaf if visually determinable."},
    "cultivar_type": {"type": ["string", "null"], "enum": ["INDICA_LEANING", "SATIVA_LEANING", "HYBRID_BALANCED", "UNKNOWN"], "description": "Broad morphological category (optional heuristic)."},
    "environment": {"type": ["string", "null"], "enum": ["INDOOR_LED", "INDOOR_HPS", "OUTDOOR_SUN", "GREENHOUSE"], "description": "Capture environment."},
    "light_ppfd_estimate": {"type": ["integer", "null"], "minimum": 0, "maximum": 2000, "description": "Approximate PPFD at canopy (µmol/m²/s) if known."},
    "camera_device": {"type": ["string", "null"], "description": "Hashed or generic device model."},
    "distance_cm": {"type": ["number", "null"], "minimum": 0, "maximum": 300, "description": "Approx. distance from camera lens to leaf plane."},
    "angle_type": {"type": ["string", "null"], "enum": ["TOP_DOWN", "OBLIQUE", "SIDE"], "description": "View geometry category."},
    "focus_quality": {"type": ["string", "null"], "enum": ["SHARP", "ACCEPTABLE", "BLUR"], "description": "Subjective focus assessment."},
    "lighting_quality": {"type": ["string", "null"], "enum": ["EVEN", "HARSH_SHADOWS", "LOW_LIGHT", "COLOR_CAST"], "description": "Lighting condition tag."},
    "capture_ts": {"type": "string", "format": "date-time", "description": "ISO8601 timestamp (UTC) when captured."},
    "annotated_ts": {"type": ["string", "null"], "format": "date-time", "description": "Annotation timestamp."},
    "annotator_id": {"type": ["string", "null"], "pattern": "^[a-zA-Z0-9_-]{3,32}$", "description": "Pseudonymous annotator ID."},
    "qc_reviewer_id": {"type": ["string", "null"], "pattern": "^[a-zA-Z0-9_-]{3,32}$", "description": "Optional second reviewer."},
    "qc_status": {"type": ["string", "null"], "enum": ["PENDING", "APPROVED", "REJECTED"], "description": "Quality review state."},
    "qc_notes": {"type": ["string", "null"], "maxLength": 500},
    "ood": {"type": ["boolean", "null"], "description": "If true, image is Out-Of-Distribution / NOT_CANNABIS."},
    "reason_ood": {"type": ["string", "null"], "maxLength": 120, "description": "Short reason for OOD marking."},
    "hash_sha256": {"type": ["string", "null"], "pattern": "^[a-f0-9]{64}$", "description": "SHA-256 of original file for integrity."},
    "augment_origin": {"type": ["string", "null"], "pattern": "^[a-zA-Z0-9_-]{4,64}$", "description": "If augmented, reference original image_id."},
    "notes": {"type": ["string", "null"], "maxLength": 500, "description": "Free-form optional comment."}
  },
  "additionalProperties": false
}
