{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "KnowledgeBaseEntry",
  "type": "object",
  "required": [
    "id", "question", "answer", "tags", "category", "sources", "created_utc", "version", "language", "disclaimers"
  ],
  "properties": {
  "id": {"type": "string", "pattern": "^[a-z0-9_-]+$"},
    "question": {"type": "string", "minLength": 5},
    "answer": {"type": "string", "minLength": 10},
    "tags": {"type": "array", "items": {"type": "string"}},
    "category": {"type": "string"},
    "sources": {"type": "array", "items": {"type": "object", "required": ["name"], "properties": {"name": {"type": "string"}, "url": {"type": "string"}, "license": {"type": "string"}}}},
    "created_utc": {"type": "string", "format": "date-time"},
    "version": {"type": "integer", "minimum": 1},
    "language": {"type": "string", "pattern": "^[a-z]{2}$"},
    "disclaimers": {"type": "array", "items": {"type": "string"}},
    "related": {"type": "array", "items": {"type": "string"}},
    "stage": {"type": "string"},
    "severity_levels": {"type": "array", "items": {"type": "string"}},
    "remediation_steps": {"type": "array", "items": {"type": "string"}},
    "detection_signals": {"type": "array", "items": {"type": "string"}}
  },
  "additionalProperties": false
}
